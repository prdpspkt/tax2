<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Tax Calculator - Gandaki Province</title>
    {% load static %}

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/styles.css' %}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="calculator-container">
            <!-- Header -->
            <div class="calculator-header">
                <h1><i class="fas fa-car"></i> Vehicle Tax Calculator</h1>
                <p class="mb-0">Gandaki Province, Nepal</p>
            </div>

            <!-- Form Section -->
            <div class="form-section">
                <div id="alerts"></div>

                <form id="taxForm" method="post">
                    {% csrf_token %}

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-id-card"></i> Registration Type *
                            </label>
                            <select class="form-select" name="reg_type" required>
                                <option value="">Select Registration Type</option>
                                {% for reg_type in reg_types %}
                                <option value="{{ reg_type.id }}"
                                        data-ambulance="{{ reg_type.is_ambulance }}"
                                        data-income-tax="{{ reg_type.needs_income_tax }}">
                                    {{ reg_type.name }} ({{ reg_type.name_en }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-tags"></i> Vehicle Category *
                            </label>
                            <select class="form-select" name="category" id="category" required>
                                <option value="">Select Vehicle Category</option>
                                {% for category in categories %}
                                <option value="{{ category.id }}" data-has-cc="{{ category.has_cc_range }}">
                                    {{ category.name }} ({{ category.name_en }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row mb-3" id="ccRow" style="display: none;">
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-tachometer-alt"></i> CC/Power/KW *
                            </label>
                            <input type="number" class="form-control" name="cc_power"
                                   step="0.01" placeholder="Enter CC/Power value">
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-calendar-check"></i> Last Paid Date (BS) *
                            </label>
                            <input type="text" class="form-control date-input" name="last_paid_date"
                                   placeholder="YYYY-MM-DD" required>
                            <small class="text-muted">Nepali date format</small>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">
                                <i class="fas fa-calendar-plus"></i> Next Payment Date (BS) *
                            </label>
                            <input type="text" class="form-control date-input" name="next_payment_date"
                                   placeholder="YYYY-MM-DD" required>
                            <small class="text-muted">Nepali date format</small>
                        </div>
                    </div>

                    <div class="text-center">
                        <button type="submit" class="btn btn-calculate">
                            <i class="fas fa-calculator"></i> Calculate Tax
                        </button>
                        <button type="button" class="btn btn-outline-secondary ms-2" onclick="resetForm()">
                            <i class="fas fa-undo"></i> Reset
                        </button>
                    </div>
                </form>

                <!-- Loading -->
                <div class="loading" id="loading">
                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                    <p>Calculating...</p>
                </div>
            </div>

            <!-- Results Section -->
            <div class="result-section" id="results"></div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{% static 'js/custom.js' %}"></script>

    <script>
        // Pass Django data to JavaScript
        window.calculateUrl = "{% url 'calc:calculate_tax' %}";
    </script>
</body>
</html>