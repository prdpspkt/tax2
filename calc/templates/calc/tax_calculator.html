<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Tax Calculator - Gandaki Province</title>
    {% load static %}

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="{% static 'css/styles.css' %}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <div class="calculator-container">
            <!-- Header -->
            <div class="calculator-header">
                <h1><i class="fas fa-car"></i> Vehicle Tax Calculator</h1>
                <p class="mb-0">Gandaki Province, Nepal</p>
                <small>Advanced Fiscal Year Based Calculation</small>
            </div>

            <!-- Form Section -->
            <div class="form-section">
                <form id="taxCalculatorForm">
                    {% csrf_token %}
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="reg_type" class="form-label">
                                <i class="fas fa-id-card"></i> Registration Type
                            </label>
                            <select class="form-select" id="reg_type" name="reg_type" required>
                                <option value="">Select Registration Type</option>
                                {% for reg_type in reg_types %}
                                <option value="{{ reg_type.id }}"
                                        data-ambulance="{{ reg_type.is_ambulance }}"
                                        data-income-tax="{{ reg_type.needs_income_tax }}">
                                    {{ reg_type.name }} ({{ reg_type.name_en }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="category" class="form-label">
                                <i class="fas fa-tags"></i> Vehicle Category
                            </label>
                            <select class="form-select" id="category" name="category" required>
                                <option value="">Select Vehicle Category</option>
                                {% for category in categories %}
                                <option value="{{ category.id }}" data-has-cc="{{ category.has_cc_range }}">
                                    {{ category.name }} ({{ category.name_en }})
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3 cc-range-input">
                            <label for="cc_power" class="form-label">
                                <i class="fas fa-tachometer-alt"></i> CC/Power/KW
                            </label>
                            <input type="number" class="form-control" id="cc_power" name="cc_power"
                                   step="0.01" placeholder="Enter CC/Power in numbers">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="last_paid_date" class="form-label">
                                <i class="fas fa-calendar-check"></i> Last Paid Date (BS)
                            </label>
                            <input type="text" class="form-control" id="last_paid_date" name="last_paid_date"
                                   placeholder="YYYY-MM-DD (e.g., 2081-04-10)" required>
                            <small class="text-muted">Nepali date format</small>
                        </div>

                        <div class="col-md-6 mb-3">
                            <label for="next_payment_date" class="form-label">
                                <i class="fas fa-calendar-plus"></i> Next Payment Date (BS)
                            </label>
                            <input type="text" class="form-control" id="next_payment_date" name="next_payment_date"
                                   placeholder="YYYY-MM-DD (e.g., 2081-10-04)" required>
                            <small class="text-muted">Nepali date format</small>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-12 text-center">
                            <button type="submit" class="btn btn-calculate">
                                <i class="fas fa-calculator"></i> Calculate Tax
                            </button>
                        </div>
                    </div>
                </form>

                <!-- Loading Section -->
                <div class="loading">
                    <i class="fas fa-spinner fa-spin fa-2x text-primary"></i>
                    <p class="mt-2">Calculating your tax...</p>
                </div>

                <!-- Error Message -->
                <div class="error-message" id="errorMessage"></div>

                <!-- Success Message -->
                <div class="success-message" id="successMessage"></div>

                <!-- Warning Message -->
                <div class="warning-message" id="warningMessage"></div>
            </div>

            <!-- Results Section -->
            <div class="result-section" id="resultsSection">
                <h3><i class="fas fa-receipt"></i> Tax Calculation Results</h3>
                <div id="calculationResults"></div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JavaScript -->
    <script src="{% static 'js/custom.js' %}"></script>
</body>
</html>